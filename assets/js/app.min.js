$(document).ready(function(){
  window.addEventListener("scroll",()=>{const e=document.getElementById("header");300<=window.scrollY?e.classList.add("active"):e.classList.remove("active")});const c=document.querySelector("body"),o=document.querySelector("#burger-menu"),e=document.querySelector("#burger-open"),t=document.querySelector("#burger-close"),s=document.querySelectorAll(".nav-list>li>a, .nav-menu>a"),r=(e.addEventListener("click",()=>{o.classList.add("show"),c.classList.add("dis-scroll")}),t.addEventListener("click",()=>{o.classList.remove("show"),c.classList.remove("dis-scroll")}),s.forEach(e=>e.addEventListener("click",()=>{o.classList.remove("show"),c.classList.remove("dis-scroll")})),document.querySelectorAll(".accordion-item")),n=(r.forEach(c=>{const e=c.querySelector(".accordion-header");e.addEventListener("click",()=>{var e=document.querySelector(".accordion-open");n(c),e&&e!==c&&n(e)})}),e=>{const c=e.querySelector(".accordion-content");e.classList.contains("accordion-open")?(c.removeAttribute("style"),e.classList.remove("accordion-open")):(c.style.height=c.scrollHeight+"px",e.classList.add("accordion-open"))})

  // Заношу в скрытое поле название страницы, чтобы передать в письмо.
  var pageTitle = document.title;
  document.querySelector('input[name="page-title"]').value = pageTitle;


  // -------------------------modal----------------------
  $('.to-state').on('click', function (event) {
    event.preventDefault();
    $('div').removeClass('active');
    $('.state').removeClass('active');
    var state = $(this).attr('data-state');
    $('.state[data-state=' + state + ']').addClass('active');
  });
  $('.close').on('click', function (event) {
    $(this).parents().removeClass('active');
  });
  jQuery(function ($) {
    $(document).mouseup(function (e) { // событие клика по веб-документу
      var div = $(".state-box"); // тут указываем ID элемента
      if (!div.is(e.target) // если клик был не по нашему блоку
        && div.has(e.target).length === 0) { // и не по его дочерним элементам
        div.parents().removeClass('active'); // скрываем его
        $('body').removeClass('modal-open');
      }
    });
  });

  document.addEventListener( 'wpcf7mailsent', function( event ) {
    $('.state[data-state="state-success"]').addClass('active');
  }, false );


  // Кнопка Показать ещё на странице категории продукции
  const showMore = document.querySelector('#production_showmore');
  const productsLength = document.querySelectorAll('#products_category_cards .pcard').length;
  let items = 6;
  if (productsLength) { showMore.style.display = 'inline-flex'; }
  if (showMore && productsLength) {
    showMore.addEventListener('click', () => {
      items += 3;
      const array = Array.from(document.querySelector('#products_category_cards').children);
      const visItems = array.slice(0, items);

      visItems.forEach(el => el.classList.add('is-visible'));

      if (visItems.length === productsLength) {
        showMore.style.display = 'none';
      }
    });
  }

});